import hashlib
import sys
import cgitb
import os
import glob

filename = sys.argv[1]
# filename = 'images/file.webp'
hasher = hashlib.md5()
with open(filename,'rb') as open_file:
    content = open_file.read()
    hasher.update(content)
hash1 = hasher.hexdigest()


list_of_files = glob.glob('MD5 hashes/*.md5')

def check_if_string_in_file(entry1, hash11):
    for entry1 in list_of_files:
        with open(entry1, 'r') as read_obj:
            for line in read_obj:
                if hash11 in line:
                    return True
        return False
if check_if_string_in_file(list_of_files, hash1):
    print("This file is a virus")
else:
    print("This file is clean")

# for file_name in list_of_files:
#     with open(file_name, 'r') as open_file_name:
#         content3 = open_file_name.read()
        # print(content3)

# with os.scandir('MD5 hashes/') as entries:
#     for entry in entries:
#         entry = entry.name 
#         print(entry)
# with open(entry, 'r') as entry_read:
#     content2 = entry_read.read()
#     print(content2)