<?php
session_start();
session_regenerate_id();
$inactive = 600;

if (isset($_SESSION['timeout'])) {
    $sessionTTL = time() - $_SESSION['timeout'];
    if ($sessionTTL > $inactive) {
        session_destroy();
        header("location: login.php");
    }
}

include('profilefunction.php');

if (!isset($_SESSION['username']))
{
    header("Location:login.php");
}
?>
<html>

    <link rel="stylesheet" type="text/css" href="css/profile.css">
    <link rel="stylesheet" type="text/css" href="css/index.css">
<head>
<title>Profile</title>
	<style>
    *
        {
        	margin: 0px;
        	padding: 0px;
        }
        .navbar 
        {
        background-color: #000000;
        position: fixed; /* Set the navbar to fixed position */
        width: 100%;
        top: 0;
        left:0;
        z-index: 999;
        
        }
      
        /* Links inside the navbar */
        .navbar a 
        {
        float: left;
        display: block;
        color: black;
        text-align: center;
        font-size: 25px;
        padding: 15px 30px;
        text-decoration: none;
        color: #ffffff;
        }
      
        .navbar a:hover {
        background: #ddd;
        color: black;
        }
    
        .navbar .profile{
          float: right;
        }
        /* Main content */
        .main {
        margin-top: 30px; /* Add a top margin to avoid content overlay */
        }
        
        .navbar .file_upload
        {
        float: right;
        }
        
    @import url(https://fonts.googleapis.com/css?family=Open+Sans:300,400,700);
    .profilepress-edit-profile-status {
      width: 400px;
      text-align: center;
      background-color: #e74c3c;
      color: #ffffff;
      border: medium none;
      border-radius: 4px;
      font-size: 17px;
      font-weight: normal;
      line-height: 1.4;
      padding: 8px 5px;
      margin: auto;
    }
    
    .memo-edprofile-success {
      width: 400px;
      text-align: center;
      background-color: #2ecc71;
      color: #ffffff;
      border: medium none;
      border-radius: 4px;
      font-size: 17px;
      font-weight: normal;
      line-height: 1.4;
      padding: 8px 5px;
      margin: auto;
    }
    
    #sc-edprofile {
      background: #f0f0f0;
      width: 400px;
      margin: 0 auto;
      margin-top: 8px;
      margin-bottom: 2%;
      transition: opacity 1s;
      -webkit-transition: opacity 1s;
    }
    
    #sc-edprofile h1 {
      background: #3399cc;
      padding: 20px 0;
      font-size: 140%;
      font-weight: 300;
      text-align: center;
      color: #fff;
    }
    
    div#sc-edprofile .sc-container {
      background: #f0f0f0;
      padding: 6% 4%;
    }
    
    div#sc-edprofile input[type="email"],
    div#sc-edprofile input[type="text"],
    div#sc-edprofile input[type="password"], div#sc-edprofile select, div#sc-edprofile textarea {
      width: 100%;
      background: #fff;
      margin-bottom: 4%;
      border: 1px solid #ccc;
      padding: 4%;
      font-family: 'Open Sans', sans-serif;
      font-size: 95%;
      color: #555;
    }
    
    div#sc-edprofile select {
      width: 100%;
    }
    
    div#sc-edprofile textarea {
      height: 100px;
    }
    
    div#sc-edprofile input[type="submit"] {
      width: 100%;
      background: #3399cc;
      border: 0;
      padding: 4%;
      font-family: 'Open Sans', sans-serif;
      font-size: 100%;
      color: #fff;
      cursor: pointer;
      transition: background .3s;
      -webkit-transition: background .3s;
    }
    
    div#sc-edprofile input[type="submit"]:hover {
      background: #2288bb;
    }
    
    .error
    {
        width: 92%;
        margin: 0px auto;
        padding: 10px;
        border: 1px solid #a94442;
        color: #a94442;
        background: #f2dede;
        border-radius: 5px;
        text-align: left;
    }

    </style>
</head>



<body style= "background: #708090"><br><br><br><br><br>
   	<div class="navbar">
    	<a href="index.php">Home</a>
    	
    	<div class="profile">
        	<a href="profile.php">Profile</a>
    	</div>
    	<?php if (isset($_SESSION['success'])): ?>
			<div class="error success"></div>
				<h3>
					<?php 
					   echo $_SESSION['success'];
					   unset($_SESSION['success']);
					?>
				</h3>
		<?php endif ?>
		
		<?php if (isset($_SESSION["username"])): ?>
			<p><a>Welcome <strong><?php echo $_SESSION['username']; ?></strong></a>
			<a href="logout.php">Logout</a></p>
			
		<?php endif ?>
		
		<div class="file_upload">
			<a href="history.php">History</a>
    		<a href="uploadfile.php">File Upload</a>
    		<a href="uploadURL.php">URL Upload</a>
    	</div>
	</div>
	<form method="post" action="profile.php">
        <div id="sc-edprofile">
            <h1>Profile Page</h1>
            <div class="sc-container">
        		
        		<br>
                <input type="text" name="email" placeholder="Email" value="<?php echo $email; ?>"/>
                <input type="password" name="password_1" placeholder="New Password" />
                <input type="password" name="password_2" placeholder="Confirm New Password" />
                <br><br>
                <input type="submit" name="update" value="Update" class="btn" />
                <br><br>
                <input type="submit" name="delete" value="Delete Account" class="btn" />
                <br><br>
            </div>
        </div>
    </form>
</body>

</html>